@model List<TaskManagement.Models.DBContext.Assignment>
@{
    ViewBag.Title = "AssignmentList";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid">
    <div class="card mx-auto mt-5" style="width:80%">


        <div class="card-header"><h2 class=" text-success">Assignment List</h2></div>
        <div class="card-body">
            <table class="table table-striped table-bordered table-success table-hover">
                <thead class="text-black bg-light">
                    <tr>
                        <th>TaskName</th>
                        <th>DeadLine</th>
                        <th>Teacher Name</th>
                        <th>Details</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        <tr>
                            <td>@item.Tasks.TaskName</td>
                            <td>@item.Tasks.Deadline</td>
                            <td>@item.Tasks.Teachers.Username</td>
                            <td>

                                <button class="btn btn-info " onclick="openModal(@item.AssignmentID)">Details</button>
                                <div id="myModalContent">
                                </div>

                            </td>
                            <td>
                                @if (item.status == false)
                                {
                                    if (@item.Tasks.Deadline > DateTime.Now)
                                    {
                                        <div><a class=" btn btn-warning" href="~/Student/SetAssignmentStatus?id=@item.AssignmentID">Please Submit</a></div>
                                    }
                                    else
                                    {
                                        <button class="btn btn-danger">Deadline over</button>
                                    }
                                }
                                else
                                {
                                    <button class="btn btn-success">Submitted</button>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>

        </div>
        <div class="card-footer"><a href="./StudentDashboard"> <button class="btn btn-warning">Back to HomePage</button></a></div>
    </div>
</div>

    <script>

        function openModal(id) {
            $.ajax({
                method: "GET",
                url: '/Student/Details/' + id,
                success: function (data) {
                    $('#myModalContent').html(data);
                    $('#myModal').modal('show');
                },
                error: function () {
                    alert("Dynamic content load failed.");
                }
            });
        }
    </script>
